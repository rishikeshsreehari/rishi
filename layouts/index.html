{{ define "main" }}
<div class="homepage">
    {{ if .Site.Params.useCustomHomepage }}
        {{- partial "home_info.html" . -}}
    {{ else }}
        {{ with .Site.Params.homepage }}
        <div class="greeting">
            <p>{{ .greeting | markdownify }}</p>
        </div>
        
        <div class="bio">
            {{ range .bio }}
            <p>{{ . | markdownify }}</p>
            {{ end }}
        </div>
        {{ end }}
    {{ end }}
    
    {{ if .Site.Params.social }}
    <div class="social-links">
        {{ range .Site.Params.social }}
        <a href="{{ .url }}" aria-label="{{ .name }}" title="{{ .name | title }}" target="_blank" rel="noopener">
            <span class="icon">{{ partial "svg.html" (dict "name" .name) }}</span>
        </a>
        {{ end }}
    </div>
    {{ end }}
    
    {{ $pages := where .Site.RegularPages "Type" "posts" }}
    
    {{ if and (.Site.Params.showPopularPosts) (where $pages "Params.popular" true) }}
    {{ $popular := where $pages "Params.popular" true }}
    <section class="posts-section">
        <h2>{{ i18n "popular_posts" | default "Popular Posts" }}</h2>
        <ul class="post-list">
        {{ range first 5 $popular }}
            <li>
                <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                <span class="post-date">{{ .Date.Format "Jan 2, 2006" }}</span>
            </li>
        {{ end }}
        </ul>
    </section>
    {{ end }}
    
    {{ if .Site.Params.showRecentPosts }}
    <section class="posts-section">
        <h2>{{ i18n "recent_posts" | default "Recent Posts" }}</h2>
        <ul class="post-list">
        {{ range first 10 $pages }}
            <li>
                <a href="{{ .RelPermalink }}">{{ .Title }}</a>
                <span class="post-date">{{ .Date.Format "Jan 2, 2006" }}</span>
            </li>
        {{ end }}
        </ul>
        <p class="view-all">
            <a href="{{ "/archive" | relLangURL }}">{{ i18n "all_posts" | default "View all posts" }} â†’</a>
        </p>
    </section>
    {{ end }}
</div>
{{ end }}